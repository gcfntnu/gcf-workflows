BFQ_INTERIM = join(INTERIM_DIR, 'singlecell', 'bfq')

include:
    'bfq/bfq_level2.rules'
include:
    'bfq/bfq_level3.rules'

if config['quant']['method'] == 'star':
    rule bfq_all:
        input:
            rules.bfq_level2_exprs_star.output,
            rules.bfq_level2_logs_star.output,
            rules.bfq_level2_aligned.output,
            join(BFQ_INTERIM, 'figs', 'umap_all_samples_mqc.png')
else:
    rule bfq_all:
        input: 
            rules.bfq_level2_exprs_cellranger.output,
            rules.bfq_level2_logs_cellranger.output,
            rules.bfq_level2_data_cellranger.output,
            rules.bfq_level2_notebooks_cellranger.output,
            join(BFQ_INTERIM, 'figs', 'umap_all_samples_mqc.png')
