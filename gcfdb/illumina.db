#-*- mode:snakemake -*-
"""External data from Illumina
"""
import tempfile

ILMN_EXT = join(EXT_DIR, 'illumina')

rule illumina_phix:
    output:
         join(ILMN_EXT, 'phix', 'fasta', 'genome.fa')
    params:
        url = 'ftp://igenome:G3nom3s4u@ussd-ftp.illumina.com/PhiX/Illumina/RTA/PhiX_Illumina_RTA.tar.gz',
        date = datetime.now().strftime("%d-%m-%Y"),
        tmp_file = tempfile.mkstemp(suffix='.tar.gz')[-1]
    log:
        join(ILMN_EXT, 'phix', 'logs', 'phix.log')
    shell:
        """
        wget -O {params.tmp_file} {params.url}
        tar xvzfO {params.tmp_file} PhiX/Illumina/RTA/Sequence/Chromosomes/phix.fa > {output}
        echo "PhiX,NA,{params.url},{params.date}" > {log}
        """
