#-*- mode:snakemake -*-
"""External data from Illumina
"""

rule illumina_phix:
    output:
         join(EXT_DIR, 'illumina', 'phix', 'fasta', 'phix.fa')
    params:
        url = 'http://igenomes.illumina.com.s3-website-us-east-1.amazonaws.com/PhiX/Illumina/RTA/PhiX_Illumina_RTA.tar.gz',
        date = datetime.now().strftime("%d-%m-%Y"),
        proxy = config.get('proxy', {}).get('wget', '')
    log:
        join(EXT_DIR, 'illumina', 'phix', 'logs', 'phix.log')
    shadow:
        'minimal'
    shell:
        """
        wget {params.proxy} {params.url}
        tar xvzfO PhiX_Illumina_RTA.tar.gz PhiX/Illumina/RTA/Sequence/Chromosomes/phix.fa > {output}
        echo "Illumina PhiX RTA,NA,{params.url},{params.date}" > {log}
        """
    
rule illumina_adaptors:
    params:
        url = join(config['winecellar']['url'], 'illumina', 'ILMN_sequences.fa'),
        date = datetime.now().strftime("%d-%m-%Y"),
        proxy = config.get('proxy', {}).get('wget', ''),
    output:
        join(EXT_DIR, 'illumina', 'adaptors', 'fasta', 'adaptors.fa')
    log:
        join(EXT_DIR, 'illumina', 'logs', 'adaptors.log')
    shell:
        """
        wget {params.proxy} -O {output} {params.url}
        echo "Illumina adaptors,NA,{params.url},{params.date}" > {log}
        """
