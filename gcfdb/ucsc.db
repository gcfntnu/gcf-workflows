#-*- mode:snakemake -*-
"""UCSC data

"""

UCSC_ORG = {'homo_sapiens': 'Human',
            'mus_musculus': 'Mouse'}
ORG = config['organism']


rule ucsc_gencode_rmsk:
    output:
        gtf = join(EXT_DIR, 'ucsc', ORG, 'genes', 'rmsk_gencode.gtf')
    params:
        url = 'https://gcf-winecellar.medisin.ntnu.no/ucsc/{}/genes/rmsk_gencode.gtf'.format(ORG),
        date = datetime.now().strftime("%d-%m-%Y")
    log:
        join(EXT_DIR, 'ucsc', ORG, 'rmsk.log')
    shell:
        """
        wget {params.url} -O-  > {output.gtf}
        echo "UCSC rmsk,NA,{params.url},{params.date}" > {log}
        """

rule ucsc_ensembl_rmsk:
    input:
        rules.ucsc_gencode_rmsk.output.gtf
    output:
        join(EXT_DIR, 'ucsc', ORG, 'genes', 'rmsk_ensembl.gtf')
    shell:
        'sed s/chr// {input} > {output}'


rule ucsc_gencode_trna:
    output:
        bed = join(EXT_DIR, 'ucsc', ORG, 'genes', 'trna_gencode.bed')
    params:
        url = 'https://gcf-winecellar.medisin.ntnu.no/ucsc/{}/genes/trna_gencode.bed'.format(ORG),
        date = datetime.now().strftime("%d-%m-%Y")
    log:
        join(EXT_DIR, 'ucsc', ORG, 'rmsk.log')
    shell:
        """
        wget {params.url} -O-  > {output.bed}
        echo "UCSC rmsk,NA,{params.url},{params.date}" > {log}
        """

rule ucsc_ensembl_trna:
    input:
        rules.ucsc_gencode_trna.output.bed
    output:
        join(EXT_DIR, 'ucsc', ORG, 'genes', 'trna_ensembl.bed')
    shell:
        'sed s/chr// {input} > {output} '
