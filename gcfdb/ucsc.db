#-*- mode:snakemake -*-
"""UCSC data

"""

UCSC_ORG = {'homo_sapiens': 'Human',
            'mus_musculus': 'Mouse'}
ORG = config['organism']


rule ucsc_gencode_rmsk:
    output:
        gtf = join(EXT_DIR, 'ucsc', ORG, 'anno', 'rmsk_gencode.gtf')
    params:
        url = join(config.get('winecellar', {}).get('url', ''), 'ucsc', ORG, 'anno', 'rmsk_gencode.gtf'),
        proxy = config.get('proxy', {}).get('wget', ''),
    log:
        join(EXT_DIR, 'ucsc', ORG, 'rmsk.log')
    shell:
        """
        wget {params.proxy} {params.url} -O-  > {output.gtf}
        echo "UCSC rmsk,NA,{params.url},`date -I`" > {log}
        """

rule ucsc_ensembl_rmsk:
    input:
        rules.ucsc_gencode_rmsk.output.gtf
    output:
        join(EXT_DIR, 'ucsc', ORG, 'anno', 'rmsk_ensembl.gtf')
    shell:
        'sed s/chr// {input} > {output}'


rule ucsc_gencode_trna:
    output:
        bed = join(EXT_DIR, 'ucsc', ORG, 'anno', 'trna_gencode.bed')
    params:
        url = join(config.get('winecellar', {}).get('url', ''), 'ucsc', ORG, 'anno', 'trna_gencode.bed'),
        proxy = config.get('proxy', {}).get('wget', ''),
    log:
        join(EXT_DIR, 'ucsc', ORG, 'rmsk.log')
    shell:
        """
        wget {params.proxy} {params.url} -O-  > {output.bed}
        echo "UCSC rmsk,NA,{params.url},`date -I`" > {log}
        """

rule ucsc_ensembl_trna:
    input:
        rules.ucsc_gencode_trna.output.bed
    output:
        join(EXT_DIR, 'ucsc', ORG, 'anno', 'trna_ensembl.bed')
    shell:
        'sed s/chr// {input} > {output} '
